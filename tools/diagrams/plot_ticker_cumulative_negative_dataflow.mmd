flowchart TB
    subgraph Entrées
        Input1[("Fichier LZ4<br/>prices_data.lz4")]
        Input2["Paramètres:<br/>- Ticker<br/>- Intervalle"]
    end
    
    subgraph "Étape 1: Chargement"
        Load[PriceLogger<br/>Décompression LZ4]
        Filter[Filtrage par ticker]
    end
    
    subgraph "Étape 2: Rééchantillonnage"
        Resample[Regrouper par intervalles<br/>de 5 minutes]
        Aggregate[Calculer moyenne<br/>des prix]
    end
    
    subgraph "Étape 3: Calcul Pertes Cumulées"
        CalcDiff[Calculer différences<br/>de prix]
        DiffFormula["Diff = Prix_t - Prix_t-1"]
        FilterNeg[Garder seulement<br/>les différences négatives]
        AbsValue[Valeur absolue<br/>des baisses]
        CumulSum[Somme cumulée<br/>des pertes]
    end
    
    subgraph "Étape 4: Visualisation"
        CreateFig[Créer figure<br/>2 sous-graphiques]
        PlotPrice[Graphique 1:<br/>Prix rééchantillonnés]
        PlotCumul[Graphique 2:<br/>Pertes cumulées]
    end
    
    subgraph Sortie
        Output[("Image PNG<br/>{ticker}_price_cumulative_negative.png")]
    end
    
    subgraph "Données intermédiaires"
        Data1["timestamps[]<br/>prices[]"]
        Data2["resampled_times[]<br/>resampled_prices[]"]
        Data3["cumulative_negative[]<br/>somme des baisses"]
    end
    
    Input1 --> Load
    Input2 --> Filter
    Load --> Filter
    
    Filter --> Data1
    Data1 --> Resample
    Resample --> Aggregate
    
    Aggregate --> Data2
    Data2 --> CalcDiff
    CalcDiff --> DiffFormula
    DiffFormula --> FilterNeg
    FilterNeg --> AbsValue
    AbsValue --> CumulSum
    
    CumulSum --> Data3
    
    Data2 --> CreateFig
    Data3 --> CreateFig
    
    CreateFig --> PlotPrice
    CreateFig --> PlotCumul
    
    PlotPrice --> Output
    PlotCumul --> Output
